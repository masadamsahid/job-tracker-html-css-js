<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Change to UTF 16 instead of UTF 8 to support CSS font-variant-emoji -->
  <meta charset="UTF-16">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Outfit:wght@100..900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="./assets/css/companies.css">
  <title>Companies</title>
</head>

<body>
  <div class="container">
    <aside class="sidebar" id="sidebar">
      <!-- Logo Section -->
      <section class="logo-section">
        <div class="logo">LOGO</div>
      </section>

      <!-- Apps Menu Section -->
      <section class="menu-section">
        <h3>Apps</h3>
        <ul class="menu-list">
          <li>
            <a href="#" class="menu-item">
              <i class="icon" data-lucide="briefcase-business"></i>
              <span>
                My Applications
              </span>
            </a>
          </li>
          <li>
            <a href="#" class="menu-item">
              <i class="icon" data-lucide="bot-message-square"></i>
              <span>
                AI Interviews
              </span>
            </a>
          </li>
        </ul>
      </section>

      <!-- User Menu Section -->
      <section class="menu-section">
        <h3>User</h3>
        <ul class="menu-list">
          <li>
            <a href="#" class="menu-item">
              <i class="icon" data-lucide="user-round"></i>
              <span>
                Profile
              </span>
              <span class="menu-shortcut">⌘ P</span>
            </a>
          </li>
          <li>
            <a href="#" class="menu-item">
              <i class="icon" data-lucide="credit-card"></i>
              <span>
                Billing
              </span>
              <span class="menu-shortcut">⌘ B</span>
            </a>
          </li>
          <li>
            <a href="#" class="menu-item">
              <i class="icon" data-lucide="settings"></i>
              <span>
                Settings
              </span>
              <span class="menu-shortcut">⌘ S</span>
            </a>
          </li>
        </ul>
      </section>

      <!-- User Profile Section -->
      <section class="user-profile-section">
        <div class="user-profile">
          <div>
            <img src="./assets/img/avatar-icon.png" alt="User Avatar" class="user-avatar">
            <div class="user-info">
              <h4 class="user-name">Budi Bedu Beda</h4>
              <p class="user-email">budibedubeda@gmail.com</p>
            </div>
          </div>

          <button class="logout-btn">Logout</button>
        </div>
      </section>

      <button id="sidebar-closer">
        <span>Close Sidebar</span>
        <i class="icon" data-lucide="panel-right-open"></i>
      </button>
    </aside>

    <main class="content-container">
      <div class="navbar">
        <div class="actions-wrapper left-actions">
          <button id="sidebar-trigger" href="#" class="action">
            <i class="icon" data-lucide="panel-right-close"></i>
          </button>
          <!-- Write some code here to add additional left icon actions -->
        </div>
        <h1 class="page-title">Companies</h1>

        <div class="actions-wrapper right-actions">
          <!-- Write some code here to add additional right icon actions -->
          <a href="#" class="action">
            <i class="icon" data-lucide="plus"></i>
          </a>
        </div>
      </div>

      <div class="content p-0">
        <div class="flex" style="height: 100%;">
          <div id="company-list" class="scrollbar-hidden">
            <div class="search-bar-wrapper">
              <input class="search-input" type="text" placeholder="Search">
              <i class="icon search-icon" data-lucide="search"></i>
            </div>
            <div id="company-card-list" class="company-card-list">
            </div>
          </div>
          <div id="company-details">
            <div class="content-header">
              <img src="./assets/data/img/company-logos/amazon_logo.jpeg" alt="" class="company-logo">
              <div class="company-info">
                <h2 class="company-name">
                  Amazon
                </h2>
                <p>
                  IT Consulting • Jakarta, Indonesia
                </p>
              </div>
              <!-- <p class="added-date">
                Added a year ago
              </p> -->
              <div class="actions">
                <button class="btn">
                  <i class="icon" data-lucide="ellipsis"></i>
                </button>
              </div>
            </div>
            <div class="content-body">
              <div class="card">
                <p>
                  Lorem ipsum dolor sit amet consectetur adipisicing elit. Id eveniet velit mollitia incidunt nemo odit, sequi corrupti consequatur ratione sapiente tempore deserunt, aspernatur quaerat placeat.
                </p>
                <p>
                  Lorem ipsum dolor sit amet consectetur adipisicing elit. Odio, tempore id? Doloribus tempora quisquam eaque omnis vitae minus quae non quam pariatur obcaecati error, aperiam blanditiis ipsam officiis? Ullam est, asperiores eaque itaque facilis ex laborum nemo repellendus officiis quam?
                </p>
                <p>
                  Lorem ipsum dolor sit amet consectetur adipisicing elit. Dignissimos inventore voluptate tenetur alias doloremque iusto soluta porro. Voluptates, aliquid eum!
                </p>
              </div>

              <div class="card">
                <h3 class="card-title">
                  Your Job Applications to Amazon
                </h3>
                <div id="your-applications-to-company-table-container">
                  <table class="table">
                    <thead>
                      <tr>
                        <th class="text-left" style="min-width: 230px;">Job Title</th>
                        <th class="text-left" style="min-width: 100px;">Status</th>
                        <th class="text-left" style="min-width: 100px;">Tracked Since</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody id="your-applications-to-company-table-body">
                      <tr>
                        <td>
                          <a href="./application-details.html?id=7" class="link">
                            Backend Developer
                          </a>
                        </td>
                        <td>
                          <div class="status-badge status-badge-interview">
                            interview
                          </div>
                        </td>
                        <td title="02, Nov 2023 at 20:30:00" class="moment-from-now">
                          a year ago
                        </td>
                        <td>
                          <button class="btn" style="margin: auto">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="ellipsis" class="lucide lucide-ellipsis icon"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
                          </button>
                        </td>
                      </tr>
                      
                      <tr>
                        <td>
                          <a href="./application-details.html?id=7" class="link">
                            Backend Developer
                          </a>
                        </td>
                        <td>
                          <div class="status-badge status-badge-interview">
                            interview
                          </div>
                        </td>
                        <td title="02, Nov 2023 at 20:30:00" class="moment-from-now">
                          a year ago
                        </td>
                        <td>
                          <button class="btn" style="margin: auto">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="ellipsis" class="lucide lucide-ellipsis icon"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
                          </button>
                        </td>
                      </tr>
                      
                      <tr>
                        <td>
                          <a href="./application-details.html?id=7" class="link">
                            Backend Developer
                          </a>
                        </td>
                        <td>
                          <div class="status-badge status-badge-interview">
                            interview
                          </div>
                        </td>
                        <td title="02, Nov 2023 at 20:30:00" class="moment-from-now">
                          a year ago
                        </td>
                        <td>
                          <button class="btn" style="margin: auto">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="ellipsis" class="lucide lucide-ellipsis icon"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
    </main>
  </div>

  <div id="overlay"></div>

  <!-- Momentjs -->
  <script src="https://cdn.jsdelivr.net/npm/moment@2.30.1/moment.min.js"></script>
  <script>
    moment.locale('en', {
      relativeTime: {
        future: 'in %s',
        past: '%s',
        s: '1s',
        ss: '%ss',
        m: '1m',
        mm: '%dm',
        h: '1h',
        hh: '%dh',
        d: '1d',
        dd: '%dd',
        M: '1m',
        MM: '%dm',
        y: '1y',
        yy: '%dy'
      }
    })

    const companyCardList = document.getElementById('company-card-list');

    let companies = [];

    async function fetchCompanies() {
      await fetch('/assets/data/companies.json').then(response => response.json())
        .then(data => {
          companies = data;
          displayCompanies(companies);
        });
    }

    console.log(window.location);
    window.addEventListener('urlChange', (e) => {
      console.log(location);
    });


    async function displayCompanies(companies) {
      companies.forEach(company => {
        const companyCard = document.createElement('div');
        companyCard.classList.add('company-card');
        companyCard.innerHTML = `
            <img src="${company.img_url}" alt="company">
            <div class="company-info">
              <h3 class="company-name">
                ${company.name}
              </h3>
              <p class="company-category">
              ${company.category}
              </p>
              <p class="company-location">
                ${company.location}
              </p>
            </div>
            <p class="date">
              ${moment(company.created_at).fromNow()}
            </p>
        `;

        companyCard.addEventListener('click', (e) => {

          // location.search = `id=${company.id}`;
          history.replaceState({}, '', `?id=${company.id}`);
          window.dispatchEvent(new Event('urlChange'));
          // console.log(location);
          console.log(`${company.name}`);
        });

        companyCardList.appendChild(companyCard);
      });
    }

    fetchCompanies();
  </script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide"></script>
  <script>
    lucide.createIcons();
  </script>
  <script src="/assets/js/sidebar.js"></script>
</body>

</html>